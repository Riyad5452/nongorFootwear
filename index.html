<!DOCTYPE html>
<html>
	<head>
	  <title>NONGOR FOOTWER</title>
	  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

<style>
  #qr-reader {
    /* Default width for all devices */
    width: 500px;
    box-sizing: border-box;
    /* Include padding and border in width calculation */
  }

  @media only screen and (max-width: 600px) {
    #qr-reader {
      width: 100%;
    }
  }
</style>
	</head>
	<body style="padding: 20px 40px;">
 <div style="flex: 0 1 auto; text-align: center; font-weight: bold; color: #172774;">NONGOR FOOTWEAR
        </div>
        <div id="usernameContainer" style="flex: 1; display: flex; justify-content: font-size: 15px;">
          <img src="https://iconape.com/wp-content/png_logo_vector/apex-shoes-logo.png" alt="Stamp" style="height: 40px;"/>
        </div>
  <div class="container">

<div id="qr-reader" class="mt-4" style="position: relative; padding: 0px; border: none;"></div>

<input type="text" class="form-control" id="productCode" name="productCode" placeholder="Scan QR/Bar Code" readonly>
</div>
    <table id="example" class="display" style="width:100%">
			<thead>
				<tr>
					<th>Arical</th>
					<th>Size</th>
					<th>Price</th>
					<th>Quantity</th>
					<!-- Add more columns as needed based on your JSON structure-->
				</tr>
			</thead>
		</table>
	<script>
$(document).ready(function() {
    // Initialize the DataTable
    var table = new DataTable('#example', {
        ajax: 'https://script.google.com/macros/s/AKfycbwIBwLhJu8ON9e7FFyZmu0jeWsWHxHq7baRBBspk0r9DRQCDrv5B6is3cJsjGqKWKxofQ/exec',
        columns: [
            { data: 'Artical' },
            { data: 'Size' },
            { data: 'Price' },
            { data: 'Quantity' }
        ]
    });

    // QR Code Scanner setup
    function docReady(fn) {
        if (document.readyState === "complete" || document.readyState === "interactive") {
            setTimeout(fn, 1);
        } else {
            document.addEventListener("DOMContentLoaded", fn);
        }
    }

    docReady(function() {
        var resultContainer = document.getElementById('qr-reader-results');
        var lastResult, countResults = 0;
        
        var html5QrcodeScanner = new Html5QrcodeScanner(
            "qr-reader", { fps: 10, qrbox: 250 });
        
        function onScanSuccess(decodedText, decodedResult) {
            if (decodedText !== lastResult) {
                ++countResults;
                lastResult = decodedText;
                console.log(`Scan result = ${decodedText}`, decodedResult);

                // resultContainer.innerHTML += `<div class="p-3 mb-2 bg-success text-white">[${countResults}] - ${decodedText}</div>`;
                
                // Assign the scanned code to productCode field
                const productCode = document.getElementById("productCode");
                productCode.value = decodedText;

                // Auto search the DataTable based on the scanned QR code value
                table.search(decodedText).draw();  // This filters the DataTable based on the scanned code
            }
        }
        
        function onScanError(qrCodeError) {
            // Handle QR scan error (optional)
        }

        html5QrcodeScanner.render(onScanSuccess, onScanError);
    });
});
</script>

<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js" type="text/javascript"></script>
</body>
